% ---------------------------------------------------
% Predict
% ---------------------------------------------------

function [x, P] = Predict(x_i, P, dt, Qi)

    x = x_i;

    % State Transition

    F = [ 1  0  0 dt  0  0 ;
          0  1  0 0  dt  0 ;
          0  0  1  0 0  dt ;
          0  0  0  1  0  0 ;
          0  0  0  0  1  0 ;
          0  0  0  0  0  1 ]; 

    % Noise Covariance

    Q = [ (dt^4)/4    0.0      0.0   (dt^3)/2    0.0       0.0     ; 
              0.0    (dt^4)/4    0.0     0.0    (dt^3)/2   0.0     ; 
              0.0      0.0    (dt^4)/4   0.0      0.0    (dt^3)/2  ; 
            (dt^3)/2    0.0      0.0    dt^2      0.0       0.0    ; 
              0.0    (dt^3)/2    0.0     0.0     dt^2       0.0    ; 
              0.0      0.0    (dt^3)/2   0.0      0.0      dt^2    ] * Qi;

    % Process noise

    w = [ (dt ^2)/2 ;
          (dt ^2)/2 ;
          (dt ^2)/2 ;
              0     ;
              0     ;
              0     ];

    x = F * x + w;
    P = F * P * F' + Q;

end
