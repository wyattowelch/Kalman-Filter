% ---------------------------------------------------
% Update
% ---------------------------------------------------

function [x, P] = Update(z, x_i, P, R, H)
    
    x = x_i;
    I = eye(6);

    y = z - H * x;
    S = (H * P * H') + R;
    K = (P * H') / S;

    x = x + (K * y);
    P = (I - K * H) * P;

end
